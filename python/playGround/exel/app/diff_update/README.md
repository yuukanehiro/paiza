# Excel データ更新ツール

## 概要
このツールは、masterファイルと新しいデータファイルを比較し、新しいIDのデータのみをmasterファイルに自動追加します。

## 事前準備（初回のみ）

### 1. Pythonのインストール
1. **Python公式サイト** にアクセス: https://www.python.org/
2. **「Downloads」** をクリック
3. **「Download Python 3.x.x」** ボタンをクリック（最新版をダウンロード）
4. ダウンロードしたファイル（`python-3.x.x-amd64.exe`）を **ダブルクリック**
5. インストール画面で **「Add Python to PATH」にチェック** ← 重要！
6. **「Install Now」** をクリック
7. インストール完了まで待つ

### 2. インストール確認
1. **Windowsキー + R** を押し、「cmd」と入力してエンター
2. 以下のコマンドを入力してエンター：
   ```
   python --version
   ```
3. `Python 3.x.x` と表示されればOK

### 3. 必要なライブラリのインストール
コマンドプロンプトで以下を実行：
```
pip install openpyxl
```

## フォルダ構成
```
exel/
├── master.xlsx          # マスターファイル（更新対象）
├── data/               # 新しいデータファイルを置く場所
├── processed/          # 処理済みファイルの保存場所（自動作成）
├── log/                # ログファイルの保存場所（自動作成）
├── cli/                # プログラムファイル
└── README.md           # このファイル
```

## 使い方

### 1. 準備
1. `master.xlsx` ファイルが存在することを確認
2. 新しいデータファイル（`.xlsx`）を `data` フォルダに配置

### 2. 実行方法
1. **Windowsキー + R** を押し、「cmd」と入力してエンターキーを押す
2. コマンドプロンプトが開いたら、以下のコマンドを入力：
   ```
   cd "このフォルダのパス"
   python cli\update_master_by_new_data.py
   ```

### 3. 実行例
```
C:\Users\ユーザー名> cd "C:\path\to\exel"
C:\path\to\exel> python cli\update_master_by_new_data.py
```

## 処理内容

### 実行されること
1. **データ比較**: masterファイルと新データファイルのID（対象id列）を比較
2. **新規データ追加**: masterにないIDのデータのみを追加
3. **ファイル移動**: 処理完了した新データファイルを `processed` フォルダに移動
4. **ログ出力**: 処理内容を `log` フォルダに記録

### 必要なファイル形式
- **master.xlsx**: 最初の列が「対象id」
- **新データファイル**: 最初の列が「対象id」で、masterと同じ列構成

## 実行結果の確認

### 成功時
```
処理が正常に完了しました
```

### 処理内容の確認
- **processed フォルダ**: 処理済みファイルが日時付きで保存
- **log フォルダ**: 詳細な処理ログが日時付きで保存

## よくある問題と解決方法

### エラー: Masterファイルが見つかりません
**原因**: `master.xlsx` がない
**解決**: `master.xlsx` ファイルを配置してください

### エラー: データディレクトリが見つかりません
**原因**: `data` フォルダがない
**解決**: `data` フォルダを作成し、新データファイルを配置してください

### エラー: 'python' は、内部コマンドまたは外部コマンド...として認識されていません
**原因**: Pythonがインストールされていない、またはPATHが設定されていない
**解決**:
1. 「事前準備」の手順でPythonを再インストール
2. インストール時に「Add Python to PATH」に必ずチェック

### エラー: No module named 'openpyxl'
**原因**: 必要なライブラリがインストールされていない
**解決**: コマンドプロンプトで以下を実行：
```
pip install openpyxl
```

### エラー: 'pip' は、内部コマンドまたは外部コマンド...として認識されていません
**原因**: Pythonのインストールが不完全
**解決**: Pythonを再インストールし、「Add Python to PATH」にチェックを入れる

## 注意事項
- **masterファイルのバックアップ**: 実行前にmasterファイルをコピーして保存することをお勧めします
- **ファイル形式**: Excelファイルのみサポートしています（.xlsx, .xls）
- **ID列**: 最初の列がIDとして使用されます

## サポート
問題が発生した場合は、`log` フォルダ内のログファイルを確認してください。
エラーの詳細情報が記録されています。